
var txt = '/body{}{ /block{ "width":"65", "paddingTop":"0vh", "paddingSide":"0vh" }{ /img{ "source":"http://beta.www.hull.ac.uk/editor-assets/images/Philosophy/philosophy.png", "width":"65vh", "height":"60vh", "padding":"0" } /txt{ "fontSize":"4vh", "fontWeight":"bold", "padding":"3.5vh", "paddingBottom":"0.5vh" }{ A BUNCH OF TEXT ABOUT SOME PROBABLY VERY IMPORTANT THINGS. } /txt{ "fontSize":"1.8vh", "fontWeight":"bold", "padding":"3.5vh", "paddingTop":"0vh", "paddingBottom":"0vh", "fontColour":"#777" }{ Discussing stuff in a really intellectual way, which is probably a lie but let\'s assume for the sake of this template. } /txt{ "fontSize":"2vh", "padding":"3.5vh", "paddingTop":"2vh", "paddingBottom":"0vh" }{ By Andy S.} /txt{ "fontSize":"2vh", "padding":"3.5vh", "paddingTop":"0vh", "paddingBottom":"2vh", "fontWeight":"bold", "fontColour":"#777" }{DEC 23, 2017} } /block{ "width":"50", "colour":"#f7f2ce", "fontColour":"black" }{ /txt{ }{ Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec pharetra quam non sollicitudin mattis. Nullam posuere odio et nibh congue, et pellentesque nibh pharetra. Cras vel bibendum turpis, in eleifend ipsum. Integer efficitur mollis dui et tristique. Etiam scelerisque molestie ante, sit amet sodales mauris consequat sed. Nam pulvinar, ligula sit amet dapibus malesuada, lacus magna faucibus nulla, consectetur elementum sapien lacus sit amet lorem. Sed sit amet rutrum dui. Praesent ultrices, dolor ut commodo interdum, erat arcu consequat ligula, sit amet malesuada neque felis nec ex. Sed quis augue odio. Vivamus at massa vel eros pretium varius. Donec dignissim felis id tellus mattis hendrerit. } } /block{ "width":"50", "colour":"#f7f2ce", "fontColour":"black"  }{ /txt{}{ Etiam elementum, arcu ac laoreet vulputate, purus sem ullamcorper odio, aliquet egestas mi urna eu metus. Mauris dapibus turpis a tincidunt iaculis. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Sed id nulla sit amet turpis maximus rutrum. Vestibulum varius, urna nec sollicitudin vulputate, tellus justo scelerisque nibh, euismod commodo ante nisi eget ipsum. Nulla non ante et risus rhoncus facilisis sed vel risus. Ut porta lacus quis magna placerat venenatis. Suspendisse ut mattis nunc. Nunc fringilla mollis velit, eu commodo augue feugiat vitae. Praesent lacus sem, gravida a arcu sit amet, commodo ultricies mauris. } } /block{ "width":"50" }{ /txt{}{ Aliquam rutrum vulputate nunc. Curabitur sapien enim, tincidunt at lorem at, dignissim iaculis orci. Sed faucibus eget nisi vitae vulputate. Vivamus aliquam dolor at mollis aliquam. Morbi lectus velit, convallis vitae tortor eget, fringilla ultrices eros. Nulla tempor elementum purus quis pellentesque. Integer egestas, odio vel suscipit varius, massa urna elementum risus, et mattis sem neque at nisl. } } /block{ "width":"50" }{ /txt{}{ Praesent id purus eu nisl lacinia faucibus in ut orci. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. In vitae dui ut turpis bibendum rhoncus. Curabitur porttitor efficitur velit, et laoreet enim blandit at. Aenean semper metus augue, id elementum orci mollis blandit. Donec blandit ipsum tellus, id finibus ex semper nec. Quisque et pretium ligula, in tincidunt sapien. Mauris mattis, eros in blandit tincidunt, libero turpis tempus lectus, et volutpat nulla mi vel purus. Proin a tellus faucibus, bibendum elit eu, fringilla quam. Phasellus turpis lectus, commodo sit amet iaculis at, ultricies vitae nulla. Proin commodo nulla at neque sodales, quis blandit ligula laoreet. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Ut sed elit pharetra nisi lacinia laoreet. Aliquam risus neque, lobortis vitae tempor sit amet, volutpat ultrices massa. Ut maximus elit eu lorem commodo eleifend. Quisque tristique blandit nisi, et interdum felis porta a. } } /block{ "width":"50" }{ /txt{}{ Donec hendrerit blandit felis ac tincidunt. Suspendisse vel ante sit amet turpis sagittis porta in a odio. Vestibulum nec ex fringilla lorem bibendum eleifend. Donec non scelerisque ligula. Sed consequat ullamcorper mi ac convallis. Fusce ac dui dignissim, fringilla nisl at, ullamcorper est. Duis vitae enim sit amet sapien consectetur tincidunt. Nulla enim dui, ornare id egestas fermentum, porta ut arcu. Phasellus ullamcorper lobortis odio, a efficitur magna dictum in. Vestibulum sed magna mollis, pharetra lorem vel, interdum est. Nulla dictum enim felis, vel laoreet leo imperdiet nec. } } /block{ "width":"50" }{ /txt{}{ Nunc nibh augue, fringilla id laoreet non, ullamcorper viverra arcu. Integer felis quam, cursus vitae rutrum et, molestie at nisi. Phasellus eget elementum risus. Nam ac condimentum ante, id aliquet lectus. Sed aliquet consequat maximus. Fusce at leo non ex fermentum consectetur. Vivamus congue ullamcorper nulla, non bibendum libero finibus vitae. Donec vehicula, felis eu tincidunt imperdiet, dolor tellus rhoncus metus, ac vulputate ligula tortor ut nibh. Phasellus blandit consequat lacus, blandit auctor risus posuere vel. Proin a ipsum arcu. Phasellus at ornare neque, viverra pellentesque lacus. Integer lacinia sodales placerat. } } /block{ "width":"50" }{ /txt{}{ Curabitur et ligula sed sem aliquam euismod. Donec rutrum sit amet odio quis convallis. Aenean dapibus enim ac varius dapibus. Vivamus vestibulum est vel nisi rutrum ultrices. Maecenas et tristique purus, a condimentum metus. Donec sed posuere justo, sit amet pretium metus. Maecenas scelerisque elementum scelerisque. } } /block{ "width":"50" }{ /txt{}{ Aliquam vel mauris at libero eleifend porttitor. Morbi vel dapibus enim, in porta est. In sit amet vehicula nisl. Nunc euismod fermentum malesuada. Nullam aliquam leo sit amet ex rhoncus, in interdum diam posuere. Morbi luctus rutrum augue, nec laoreet felis condimentum sed. Aliquam elit neque, viverra id bibendum sed, pharetra eu felis. Etiam vestibulum magna nec quam porttitor aliquet. Cras ex est, laoreet ut scelerisque vitae, fermentum eu erat. Cras orci ligula, consectetur sit amet sollicitudin ut, varius non enim. } } /block{ "width":"50" }{ /txt{}{ Aliquam volutpat vitae magna at hendrerit. Nullam ligula felis, mollis et metus in, mollis ultricies lacus. Duis eget mauris sed nisl interdum ultricies. Duis nibh purus, interdum nec dolor sed, tincidunt tempus dolor. Vestibulum vitae faucibus arcu. Suspendisse nibh orci, pulvinar quis ante et, porttitor pellentesque nulla. Praesent ac mi pulvinar velit lobortis laoreet. Suspendisse posuere eget felis sed efficitur. Nullam pretium, ex a consectetur condimentum, velit magna hendrerit est, a dignissim ante nunc a augue. Nulla bibendum neque pellentesque, dictum massa molestie, rutrum nulla. } } /block{ "width":"50" }{ /txt{}{ Fusce eget enim pretium, rhoncus dui eu, dictum nibh. Vestibulum sit amet molestie tellus. Pellentesque fringilla, enim et varius feugiat, ligula libero malesuada quam, a vestibulum neque libero sed orci. Morbi mattis ligula nec ornare convallis. Aenean pharetra massa lectus, id aliquam tellus fringilla sit amet. Nam nec eros eu purus rhoncus semper. Pellentesque semper id leo in iaculis. Donec accumsan lorem felis, eu placerat ex consequat sit amet. Phasellus vehicula tortor at dignissim suscipit. } } /block{ "width":"50" }{ /txt{}{ Phasellus fringilla, tellus in placerat imperdiet, lectus justo volutpat ligula, at mollis neque neque non velit. Vestibulum sit amet velit dolor. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Proin non turpis justo. Sed fermentum vestibulum dapibus. Donec et ante et risus vulputate sollicitudin et eu ligula. Donec est elit, dapibus sed sollicitudin in, commodo sit amet purus. Suspendisse quam elit, laoreet vel tristique vitae, euismod eu mauris. Praesent eget congue felis. Ut sodales mi mauris, nec rhoncus nibh congue quis. Curabitur varius nunc lacus. Morbi ac diam suscipit, porttitor ipsum eu, facilisis metus. } } /block{ "width":"50" }{ /txt{}{ In ante nibh, convallis nec elementum non, vulputate nec elit. Suspendisse bibendum, leo vel lobortis tempus, urna sem scelerisque sapien, sed lobortis neque orci id quam. Donec ut justo purus. Nam ac leo feugiat, hendrerit libero id, fringilla massa. Fusce finibus posuere arcu, eget posuere ante blandit posuere. Nam ultricies sem nec quam viverra eleifend. Suspendisse vel lorem ligula. Integer purus elit, faucibus eu porttitor non, scelerisque id leo. Vestibulum blandit nisi non augue semper, ac sollicitudin elit vestibulum. Pellentesque tortor mauris, commodo non dui gravida, auctor vestibulum urna. Etiam sed odio massa. Sed semper vehicula quam a dignissim. Pellentesque a ipsum sed lectus vestibulum consectetur eu vitae erat. Mauris a posuere nunc. Morbi felis elit, gravida vitae purus non, dignissim aliquam mi. Aenean mollis aliquam orci id dapibus. } } /block{ "width":"50" }{ /txt{}{ Phasellus posuere congue venenatis. Maecenas semper, odio at vehicula porta, ipsum neque feugiat augue, bibendum accumsan orci odio a orci. Nunc ultricies congue ultricies. Sed mollis arcu et mi posuere, fringilla vulputate diam cursus. Cras porttitor tincidunt leo, a maximus mauris sodales ut. Sed varius ornare ante, a molestie lacus tristique id. Suspendisse vel malesuada arcu, sit amet euismod nisi. Aenean eget aliquet elit. Praesent quis consequat ante. Etiam ligula tellus, bibendum nec lacus at, consequat lacinia libero. Nunc aliquam tincidunt pharetra. } } /block{ "width":"50" }{ /txt{}{ Integer eros nisl, mollis ac finibus lobortis, faucibus sed sem. Pellentesque nulla mauris, congue eu risus sit amet, condimentum facilisis nibh. Aenean pulvinar leo at libero lacinia placerat vitae in lacus. Nullam eget maximus nisl, nec bibendum augue. Aliquam erat volutpat. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Cras rutrum ante ac nisi ullamcorper, sit amet eleifend quam laoreet. Pellentesque faucibus viverra iaculis. Nullam iaculis molestie eros et rutrum. Suspendisse non efficitur augue, a dapibus arcu. Integer eu tempus quam. Donec ante enim, finibus sit amet ex at, varius mattis magna. Sed sed ligula at est semper iaculis. } } /block{ "width":"50" }{ /txt{}{ Cras sodales enim lectus, id iaculis sem ullamcorper id. Pellentesque quis velit ac tellus molestie sodales. Maecenas tristique ex quis purus elementum maximus. Ut ut placerat nibh. Proin pulvinar pretium cursus. Donec lobortis ipsum vel risus posuere, id fringilla orci condimentum. Vestibulum lacinia arcu id leo pulvinar, ut congue libero eleifend. Vestibulum fermentum viverra urna facilisis pulvinar. Pellentesque tempus porta est id tincidunt. Duis luctus velit eget imperdiet tempor. Duis vel metus sit amet ante luctus interdum. } } }'

var browser = {
	opera:(!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0,
    firefox:typeof InstallTrigger !== 'undefined',
    ie:/*@cc_on!@*/false || !!document.documentMode,
    edge:!this.ie && !!window.StyleMedia,
    chrome:!!window.chrome && !!window.chrome.webstore,
}
browser.safari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || safari.pushNotification);

//printPages(txt)
setTimeout(function(){
	loadPages(txt)
},0)

function getLength(f,r) {
	if (!r) r = 1000;
	var init_ = (new Date).getTime();
	for (var i = 0; i < r; i++) {
		f();
	}
	return ((new Date).getTime()-init_)/r + "s";
}

document.getElementById("wrap").addEventListener("scroll", function (e) {
	//console.log(new Date().getSeconds(),e)
	var el = (browser.firefox?e.originalTarget:e.srcElement);
	document.getElementById("progressBar").style.width = (100*el.scrollTop/(el.scrollHeight-el.clientHeight))+"vw"
})

if (browser.firefox) {
	document.getElementById("wrap").addEventListener("DOMMouseScroll", function (e) {
		//console.log("Firefox Mousewheel:",e)

		var delta = null,
        direction = false
	    ;
	    if ( !e ) { // if the event is not provided, we get it from the window object
	        e = window.event;
	    }
	    if ( e.wheelDelta ) { // will work in most cases
	        delta = e.wheelDelta / 60;
	    } else if ( e.detail ) { // fallback for Firefox
	        delta = -e.detail / 2;
	    }
	    if ( delta !== null ) {
	        direction = delta > 0 ? 'up' : 'down';
	    }

	    //console.log(direction, delta*200/3);

		printNeeded(book, 2*delta*200/3);

	})
} else {
	document.getElementById("wrap").addEventListener("mousewheel", function (e) {
		console.log("Mousewheel:",e.deltaY)
		printNeeded(book, 2*e.deltaY);

	})
}

window.addEventListener("resize", function() {
	var vis = chaptersVisible(book)
	//console.log("Visible on resize:",vis)
	clearPages(book)
	var context = (vis.full.length > 0?vis.full[0]:(vis.right.length > 0?vis.right[0]:(vis.left.length > 0?vis.left[0]:0)))
	printChapter(book,context)
	printNeeded(book,0,context)
});

function printNeeded(book, deltaY, context) {
	for (var i = 0; i < book.children.length; i++) {
		var nextPrint = lookupNextChapterGen(book, deltaY, context)
		//console.log("toPrint:",nextPrint)
		if (nextPrint == -1) break;
		else {
			var contextOffset = document.getElementById("wrap").scrollTop - book.children[nextPrint.context].pageStart;
			printChapter(book,nextPrint.gen)
			document.getElementById("wrap").scrollTop = book.children[nextPrint.context].pageStart + contextOffset;
		}
	}
}